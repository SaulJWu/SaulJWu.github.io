(window.webpackJsonp=window.webpackJsonp||[]).push([[206],{697:function(s,t,_){"use strict";_.r(t);var r=_(15),e=Object(r.a)({},(function(){var s=this,t=s.$createElement,_=s._self._c||t;return _("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[_("h2",{attrs:{id:"wordpress-简介"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#wordpress-简介"}},[s._v("#")]),s._v(" WordPress 简介")]),s._v(" "),_("p",[s._v("WordPress 是使用 PHP 开发的博客平台，用户可以在支持 PHP 和 MySQL 数据库的环境中架设属于自己的网站。本文以创建一个 "),_("a",{attrs:{href:"https://v2-1.docs.kubesphere.io/docs/zh-CN/quick-start/wordpress-deployment/www.wordpress.com/%E2%80%8E",target:"_blank",rel:"noopener noreferrer"}},[s._v("Wordpress 应用"),_("OutboundLink")],1),s._v(" 为例，以创建 KubeSphere 应用的形式将 Wordpress 的组件（MySQL 和 Wordpress）创建后发布至 Kubernetes 中，并在集群外访问 Wordpress 服务。")]),s._v(" "),_("p",[s._v("一个完整的 Wordpress 应用会包括以下 Kubernetes 对象，其中 MySQL 作为后端数据库，Wordpress 本身作为前端提供浏览器访问。")]),s._v(" "),_("p",[_("img",{attrs:{src:"https://gitee.com/SaulJWu/blog-images/raw/master/images/20210809134800.png",alt:"img"}})]),s._v(" "),_("p",[s._v("每个程序有自己的pvc。")]),s._v(" "),_("h2",{attrs:{id:"前提条件"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#前提条件"}},[s._v("#")]),s._v(" 前提条件")]),s._v(" "),_("p",[s._v("已创建了企业空间、项目和普通用户 "),_("code",[s._v("project-regular")]),s._v("账号（该已账号已被邀请至示例项目），并开启了外网访问，请参考 "),_("a",{attrs:{href:"https://v2-1.docs.kubesphere.io/docs/zh-CN/quick-start/admin-quick-start",target:"_blank",rel:"noopener noreferrer"}},[s._v("多租户管理快速入门"),_("OutboundLink")],1),s._v("。")]),s._v(" "),_("h2",{attrs:{id:"预估时间"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#预估时间"}},[s._v("#")]),s._v(" 预估时间")]),s._v(" "),_("p",[s._v("约 10 分钟。")]),s._v(" "),_("h2",{attrs:{id:"创建密钥"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#创建密钥"}},[s._v("#")]),s._v(" 创建密钥")]),s._v(" "),_("p",[s._v("MySQL 的环境变量 "),_("code",[s._v("MYSQL_ROOT_PASSWORD")]),s._v("即 root 用户的密码属于敏感信息，不适合以明文的方式表现在步骤中，因此以创建密钥的方式来代替该环境变量。创建的密钥将在创建 MySQL 的容器组设置时作为环境变量写入。")]),s._v(" "),_("h3",{attrs:{id:"创建-mysql-密钥"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#创建-mysql-密钥"}},[s._v("#")]),s._v(" 创建 MySQL 密钥")]),s._v(" "),_("ol",[_("li",[s._v("以项目普通用户 "),_("code",[s._v("project-regular")]),s._v("登录 KubeSphere，在当前项目下左侧菜单栏的 "),_("strong",[s._v("配置中心")]),s._v(" 选择 "),_("strong",[s._v("密钥")]),s._v("，点击 "),_("strong",[s._v("创建")]),s._v("。")])]),s._v(" "),_("p",[_("img",{attrs:{src:"https://pek3b.qingstor.com/kubesphere-docs/png/20191027202848.png",alt:"img"}})]),s._v(" "),_("ol",{attrs:{start:"2"}},[_("li",[s._v("填写密钥的基本信息，完成后点击 "),_("strong",[s._v("下一步")]),s._v("。")])]),s._v(" "),_("ul",[_("li",[s._v("名称：作为 MySQL 容器中环境变量的名称，可自定义，例如 "),_("code",[s._v("mysql-secret")])]),s._v(" "),_("li",[s._v("别名：别名可以由任意字符组成，帮助您更好的区分资源，例如 "),_("code",[s._v("MySQL 密钥")])]),s._v(" "),_("li",[s._v("描述信息：简单介绍该密钥，如 "),_("code",[s._v("MySQL 初始密码")])])]),s._v(" "),_("ol",{attrs:{start:"3"}},[_("li",[s._v("密钥设置页，填写如下信息，完成后点击 "),_("strong",[s._v("创建")]),s._v("。")])]),s._v(" "),_("ul",[_("li",[s._v("类型：选择 "),_("code",[s._v("默认")]),s._v("(Opaque)")]),s._v(" "),_("li",[s._v("Data：Data 键值对填写 "),_("code",[s._v("MYSQL_ROOT_PASSWORD")]),s._v("和 "),_("code",[s._v("123456")]),s._v(" "),_("ul",[_("li",[s._v("去docker hub中找到它的环境变量，所以才要填上MYSQL_ROOT_PASSWORD")])])])]),s._v(" "),_("p",[_("img",{attrs:{src:"https://gitee.com/SaulJWu/blog-images/raw/master/images/20210809135605.png",alt:"img"}})]),s._v(" "),_("h3",{attrs:{id:"创建-wordpress-密钥"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#创建-wordpress-密钥"}},[s._v("#")]),s._v(" 创建 WordPress 密钥")]),s._v(" "),_("p",[s._v("同上，创建一个 WordPress 密钥，Data 键值对填写 "),_("code",[s._v("WORDPRESS_DB_PASSWORD")]),s._v("和 "),_("code",[s._v("123456")]),s._v("。此时两个密钥都创建完成。")]),s._v(" "),_("p",[_("img",{attrs:{src:"https://gitee.com/SaulJWu/blog-images/raw/master/images/20210809135630.png",alt:"img"}})]),s._v(" "),_("h2",{attrs:{id:"创建存储卷"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#创建存储卷"}},[s._v("#")]),s._v(" 创建存储卷")]),s._v(" "),_("ol",[_("li",[s._v("在当前项目下左侧菜单栏的 "),_("code",[s._v("存储卷")]),s._v("，点击 "),_("code",[s._v("创建")]),s._v("，基本信息如下。")])]),s._v(" "),_("p",[_("img",{attrs:{src:"https://gitee.com/SaulJWu/blog-images/raw/master/images/20210809140211.png",alt:"image-20210809140211357"}})]),s._v(" "),_("ul",[_("li",[s._v("名称：wordpress-pvc")]),s._v(" "),_("li",[s._v("别名：Wordpress 持久化存储卷")]),s._v(" "),_("li",[s._v("描述信息：Wordpress PVC")])]),s._v(" "),_("ol",{attrs:{start:"2"}},[_("li",[s._v("完成后点击 "),_("code",[s._v("下一步")]),s._v("，存储类型默认 local，访问模式和存储卷容量也可以使用默认值，点击 "),_("code",[s._v("下一步")]),s._v("，直接创建即可。")])]),s._v(" "),_("p",[_("img",{attrs:{src:"https://gitee.com/SaulJWu/blog-images/raw/master/images/20210809140017.png",alt:"img"}})]),s._v(" "),_("p",[s._v("同理，也创建mysql-pvc")]),s._v(" "),_("p",[s._v("创建完，2个pvc都是等待中，等有人使用才会挂载它。")]),s._v(" "),_("h2",{attrs:{id:"创建应用"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#创建应用"}},[s._v("#")]),s._v(" 创建应用")]),s._v(" "),_("h3",{attrs:{id:"_1、在左侧菜单栏选择-应用负载-→-应用→-自制应用-然后点击-部署新应用。"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1、在左侧菜单栏选择-应用负载-→-应用→-自制应用-然后点击-部署新应用。"}},[s._v("#")]),s._v(" 1、在左侧菜单栏选择 "),_("strong",[s._v("应用负载 → 应用→ 自制应用")]),s._v("，然后点击 "),_("strong",[s._v("部署新应用")]),s._v("。")]),s._v(" "),_("ul",[_("li",[s._v("应用名称：必填，起一个简洁明了的名称，便于用户浏览和搜索，例如填写 "),_("code",[s._v("wordpress-application")])]),s._v(" "),_("li",[s._v("描述信息：简单介绍该工作负载，方便用户进一步了解")])]),s._v(" "),_("h3",{attrs:{id:"_2、添加mysql组件。"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2、添加mysql组件。"}},[s._v("#")]),s._v(" 2、添加mysql"),_("strong",[s._v("组件")]),s._v("。")]),s._v(" "),_("ul",[_("li",[s._v("名称： mysql")]),s._v(" "),_("li",[s._v("组件版本：v1")]),s._v(" "),_("li",[s._v("别名：MySQL 数据库")]),s._v(" "),_("li",[s._v("负载类型：选择 "),_("code",[s._v("有状态服务")]),s._v(" "),_("ul",[_("li",[s._v("有状态服务：需要持久化存储的")]),s._v(" "),_("li",[s._v("无状态服务：不需要持久化存储的")])])])]),s._v(" "),_("p",[_("img",{attrs:{src:"https://gitee.com/SaulJWu/blog-images/raw/master/images/20210809140918.png",alt:"image-20210809140918446"}})]),s._v(" "),_("h4",{attrs:{id:"_2-1、添加容器镜像"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、添加容器镜像"}},[s._v("#")]),s._v(" 2.1、添加容器镜像")]),s._v(" "),_("p",[_("img",{attrs:{src:"https://gitee.com/SaulJWu/blog-images/raw/master/images/20210809141055.png",alt:"image-20210809141055795"}})]),s._v(" "),_("p",[s._v("点击 "),_("strong",[s._v("添加容器镜像")]),s._v("，镜像填写 "),_("code",[s._v("mysql:5.6")]),s._v("（应指定镜像版本号)，然后按回车键或点击 DockerHub，点击 "),_("code",[s._v("使用默认端口")]),s._v("。")]),s._v(" "),_("p",[_("img",{attrs:{src:"https://gitee.com/SaulJWu/blog-images/raw/master/images/20210809141044.png",alt:"image-20210809141044156"}})]),s._v(" "),_("p",[s._v("相当于dokcer中的3306暴露到服务的3306端口")]),s._v(" "),_("h4",{attrs:{id:"_2-2、设置资源"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、设置资源"}},[s._v("#")]),s._v(" 2.2、设置资源")]),s._v(" "),_("p",[_("strong",[s._v("提示: 注意，在"),_("code",[s._v("高级设置")]),s._v("中确保内存限制 ≥ 1000 Mi,否则可能 MySQL 会因内存 Limit 不够而无法启动。")])]),s._v(" "),_("p",[_("img",{attrs:{src:"https://gitee.com/SaulJWu/blog-images/raw/master/images/20210809141311.png",alt:"image-20210809141311611"}})]),s._v(" "),_("h4",{attrs:{id:"_2-3、配置环境变量"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-3、配置环境变量"}},[s._v("#")]),s._v(" 2.3、配置环境变量")]),s._v(" "),_("p",[s._v("下滑至环境变量，在此勾选 "),_("code",[s._v("环境变量")]),s._v("，然后选择 "),_("code",[s._v("引用配置文件或密钥")]),s._v("，名称填写为 "),_("code",[s._v("MYSQL_ROOT_PASSWORD")]),s._v("（这个名称必须是docker hub中指定的），下拉框中选择密钥为 "),_("code",[s._v("mysql-secret")]),s._v("和 "),_("code",[s._v("MYSQL_ROOT_PASSWORD")]),s._v("。")]),s._v(" "),_("p",[s._v("完成后点击右下角 "),_("code",[s._v("√")]),s._v("。")]),s._v(" "),_("h4",{attrs:{id:"_2-4、添加存储卷"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-4、添加存储卷"}},[s._v("#")]),s._v(" 2.4、添加存储卷")]),s._v(" "),_("p",[s._v("官方文档是从头到尾新增一个，这里我们选择刚才创建的PV，")]),s._v(" "),_("ul",[_("li",[s._v("挂载路径：存储卷在容器内的挂载路径，选择 "),_("code",[s._v("读写")]),s._v("，路径填写 "),_("code",[s._v("/var/lib/mysql")]),s._v(" "),_("ul",[_("li",[s._v("这个路径也是要看docker hub中的设置，其实就是类似自己运行docker的时候指定挂载目录")])])])]),s._v(" "),_("p",[s._v("完成后点击 "),_("code",[s._v("√")]),s._v("。")]),s._v(" "),_("p",[_("img",{attrs:{src:"https://gitee.com/SaulJWu/blog-images/raw/master/images/20210809145758.png",alt:"image-20210809145758219"}})]),s._v(" "),_("h3",{attrs:{id:"_3、添加wordpress组件"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3、添加wordpress组件"}},[s._v("#")]),s._v(" 3、添加wordpress组件")]),s._v(" "),_("p",[s._v("刚才添加了mysql组件，接下来添加wordpress组件。")]),s._v(" "),_("ul",[_("li",[s._v("名称： wordpress")]),s._v(" "),_("li",[s._v("组件版本：v1")]),s._v(" "),_("li",[s._v("别名：Wordpress前端")]),s._v(" "),_("li",[s._v("负载类型：默认 "),_("code",[s._v("无状态服务")])])]),s._v(" "),_("p",[_("img",{attrs:{src:"https://gitee.com/SaulJWu/blog-images/raw/master/images/20210809150019.png",alt:"image-20210809150019035"}})]),s._v(" "),_("h4",{attrs:{id:"_3-1、指定容器地址"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-1、指定容器地址"}},[s._v("#")]),s._v(" 3.1、指定容器地址")]),s._v(" "),_("p",[s._v("点击 "),_("strong",[s._v("添加容器镜像")]),s._v("，镜像填写 "),_("code",[s._v("wordpress:4.8-apache")]),s._v("（应指定镜像版本号)，然后按回车键或点击 DockerHub，点击 "),_("code",[s._v("使用默认端口")]),s._v("。")]),s._v(" "),_("p",[_("img",{attrs:{src:"https://gitee.com/SaulJWu/blog-images/raw/master/images/20210809150110.png",alt:"image-20210809150110341"}})]),s._v(" "),_("h4",{attrs:{id:"_3-2、设置资源"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-2、设置资源"}},[s._v("#")]),s._v(" 3.2、设置资源")]),s._v(" "),_("p",[s._v("资源使用默认即可")]),s._v(" "),_("h4",{attrs:{id:"_3-3、配置环境变量"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-3、配置环境变量"}},[s._v("#")]),s._v(" 3.3、配置环境变量")]),s._v(" "),_("p",[s._v("这里需要添加两个环境变量：")]),s._v(" "),_("ul",[_("li",[s._v("点击 "),_("strong",[s._v("引用配置文件或密钥")]),s._v("，名称填写 "),_("code",[s._v("WORDPRESS_DB_PASSWORD")]),s._v("，选择在第一步创建的配置 (Secret) "),_("code",[s._v("wordpress-secret")]),s._v("和 "),_("code",[s._v("WORDPRESS_DB_PASSWORD")]),s._v("。")]),s._v(" "),_("li",[s._v("点击 "),_("strong",[s._v("添加环境变量")]),s._v("，名称填写 "),_("code",[s._v("WORDPRESS_DB_HOST")]),s._v("，值填写 "),_("code",[s._v("mysql")]),s._v("，对应的是上一步创建 MySQL 服务的名称，否则无法连接 MySQL 数据库。")])]),s._v(" "),_("p",[s._v("完成后点击 "),_("code",[s._v("√")]),s._v("。")]),s._v(" "),_("p",[_("img",{attrs:{src:"https://gitee.com/SaulJWu/blog-images/raw/master/images/20210809150344.png",alt:"image-20210809150344378"}})]),s._v(" "),_("h4",{attrs:{id:"_3-4-、添加存储卷"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-、添加存储卷"}},[s._v("#")]),s._v(" 3.4 、添加存储卷")]),s._v(" "),_("p",[s._v("点击 "),_("code",[s._v("添加存储卷")]),s._v("，选择已有存储卷 "),_("code",[s._v("wordpress-pvc")]),s._v("，访问模式改为 "),_("code",[s._v("读写")]),s._v("，容器挂载路径 "),_("code",[s._v("/var/www/html")]),s._v("。完成后点击 "),_("code",[s._v("√")]),s._v("。")]),s._v(" "),_("p",[_("img",{attrs:{src:"https://pek3b.qingstor.com/kubesphere-docs/png/20191027174709.png",alt:"img"}})]),s._v(" "),_("h3",{attrs:{id:"_4、创建应用"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4、创建应用"}},[s._v("#")]),s._v(" 4、创建应用")]),s._v(" "),_("p",[s._v("检查 WordPress 组件信息无误后，再次点击 "),_("code",[s._v("√")]),s._v("，此时 MySQL 和 WordPress 组件信息都已添加完成，点击 "),_("code",[s._v("创建")]),s._v("。")]),s._v(" "),_("h2",{attrs:{id:"监控应用"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#监控应用"}},[s._v("#")]),s._v(" 监控应用")]),s._v(" "),_("p",[s._v("点击应用就可以看到更新中")]),s._v(" "),_("p",[_("img",{attrs:{src:"https://gitee.com/SaulJWu/blog-images/raw/master/images/20210809150701.png",alt:"image-20210809150701767"}})]),s._v(" "),_("p",[s._v("点击容器组，就可以看到容器在创建中")]),s._v(" "),_("p",[s._v("随意点击一个容器，然后点击事件，就可以看得到它的初始化过程：")]),s._v(" "),_("p",[_("img",{attrs:{src:"https://gitee.com/SaulJWu/blog-images/raw/master/images/20210809150927.png",alt:"image-20210809150927432"}})]),s._v(" "),_("p",[s._v("当容器组都准备好，可以去存储卷看到都是准备就绪")]),s._v(" "),_("p",[_("img",{attrs:{src:"https://gitee.com/SaulJWu/blog-images/raw/master/images/20210809151017.png",alt:"image-20210809151017208"}})]),s._v(" "),_("h2",{attrs:{id:"查看应用资源"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#查看应用资源"}},[s._v("#")]),s._v(" 查看应用资源")]),s._v(" "),_("p",[_("code",[s._v("工作负载")]),s._v("下查看 "),_("strong",[s._v("部署")]),s._v(" 和 "),_("strong",[s._v("有状态副本集")]),s._v(" 的状态，当它们都显示为 "),_("code",[s._v("运行中")]),s._v("，说明 WordPress 应用创建成功。")]),s._v(" "),_("p",[_("img",{attrs:{src:"https://pek3b.qingstor.com/kubesphere-docs/png/20191027213213.png",alt:"img"}})]),s._v(" "),_("p",[_("img",{attrs:{src:"https://pek3b.qingstor.com/kubesphere-docs/png/20191027213150.png",alt:"img"}})]),s._v(" "),_("h2",{attrs:{id:"外网访问"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#外网访问"}},[s._v("#")]),s._v(" 外网访问")]),s._v(" "),_("p",[s._v("访问 Wordpress 服务前，查看 wordpress 服务，将外网访问设置为 "),_("code",[s._v("NodePort")]),s._v("。")]),s._v(" "),_("p",[_("img",{attrs:{src:"https://gitee.com/SaulJWu/blog-images/raw/master/images/20210809151336.png",alt:"image-20210809151336471"}})]),s._v(" "),_("p",[s._v("点击 "),_("code",[s._v("更多操作")]),s._v("→ "),_("code",[s._v("编辑外网访问")]),s._v("，选择 "),_("code",[s._v("NodePort")]),s._v("，然后该服务将在每个节点打开一个节点端口，通过 "),_("code",[s._v("点击访问")]),s._v("即可在浏览器访问 WordPress。")]),s._v(" "),_("p",[_("img",{attrs:{src:"https://pek3b.qingstor.com/kubesphere-docs/png/20191027213826.png",alt:"img"}})]),s._v(" "),_("blockquote",[_("p",[_("strong",[s._v("提示：此时也可以通过工具箱的 web kubctl 查看当前项目中 Wordpress 应用正在运行的所有资源。")])])]),s._v(" "),_("p",[_("img",{attrs:{src:"https://pek3b.qingstor.com/kubesphere-docs/png/20191027220246.png",alt:"img"}})]),s._v(" "),_("h2",{attrs:{id:"访问-wordpress"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#访问-wordpress"}},[s._v("#")]),s._v(" 访问 Wordpress")]),s._v(" "),_("p",[s._v("以上访问将通过 "),_("code",[s._v("http://{$节点 IP}:{$节点端口 NodePort}")]),s._v("访问 WordPress 博客网站。")]),s._v(" "),_("p",[_("img",{attrs:{src:"https://pek3b.qingstor.com/kubesphere-docs/png/20191027213826.png",alt:"img"}})]),s._v(" "),_("p",[s._v("至此，您已经熟悉了如何通过创建一个 KubeSphere 应用的方式，通过快速添加多个组件来完成一个应用的构建，最终发布至 Kubernetes。这种创建应用的形式非常适合微服务的构建，只需要将各个组件容器化以后，即可通过这种方式快速创建一个完整的微服务应用并发布 Kubernetes。")]),s._v(" "),_("p",[s._v("同时，这种方式还支持用户以 "),_("strong",[s._v("无代码侵入的形式开启应用治理")]),s._v("，针对 "),_("strong",[s._v("微服务、流量治理、灰度发布与 Tracing")]),s._v(" 等应用场景，开启应用治理后会在每个组件中以 SideCar 的方式注入 Istio-proxy 容器来接管流量，后续将以一个 Bookinfo 的示例来说明如何在创建应用中使用应用治理。")])])}),[],!1,null,null,null);t.default=e.exports}}]);