(window.webpackJsonp=window.webpackJsonp||[]).push([[191],{570:function(s,e,a){"use strict";a.r(e);var t=a(20),n=Object(t.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"oauth2-0介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#oauth2-0介绍"}},[s._v("#")]),s._v(" OAuth2.0介绍")]),s._v(" "),a("p",[s._v("OAuth（开放授权）是一个开放标准，允许用户授权第三方应用访问他们存储在另外的服务提供者上的信息，而不需要将用户名和密码提供给第三方应用或分享他们数据的所有内容。OAuth2.0是Oauth协议的延续版本，但不向后兼容OAuth1.0，即完全废止了OAuth1.0。很多大公司如Google，Yahoo，Miicrosoft等都挺了OAuth认证服务，这些都足以说明OAuth标准逐渐成为开放资源授权的标准。")]),s._v(" "),a("p",[s._v("OAuth协议目前发展到2.0版本，1.0版本过于复杂，2.0版本已得到广泛应用。")]),s._v(" "),a("h2",{attrs:{id:"例子"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#例子"}},[s._v("#")]),s._v(" 例子")]),s._v(" "),a("p",[s._v("QQ、微博、Github等网站的用户量非常大，别的网站为了简化自动网站的登陆与注册逻辑，引入社交登陆功能；")]),s._v(" "),a("p",[s._v("步骤：")]),s._v(" "),a("ul",[a("li",[s._v("1、用户点击QQ按钮")]),s._v(" "),a("li",[s._v("2、引导跳转到QQ授权页")]),s._v(" "),a("li",[s._v("3、用户主动点击授权，跳回之前网页。")])]),s._v(" "),a("h2",{attrs:{id:"作用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#作用"}},[s._v("#")]),s._v(" 作用")]),s._v(" "),a("p",[s._v("对于用户相关的OpenAPI（例如获取用户信息，动态懂不，照片，日志，分享等），为了保护用户数据的安全和隐私，第三方网站访问用户数据前都需要显式的向用户征求授权。")]),s._v(" "),a("h2",{attrs:{id:"运行流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行流程"}},[s._v("#")]),s._v(" 运行流程")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/SaulJWu/images/main/20210212190407.png",alt:"OAuth运行流程"}})]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("（A）用户打开客户端以后，客户端要求用户给予授权。\n\n（B）用户同意给予客户端授权。\n\n（C）客户端使用上一步获得的授权，向认证服务器申请令牌。\n\n（D）认证服务器对客户端进行认证以后，确认无误，同意发放令牌。\n\n（E）客户端使用令牌，向资源服务器申请获取资源。\n\n（F）资源服务器确认令牌无误，同意向客户端开放资源。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h2",{attrs:{id:"基本概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本概念"}},[s._v("#")]),s._v(" 基本概念")]),s._v(" "),a("p",[s._v("为了搞清楚运行流程，必须掌握4个概念。")]),s._v(" "),a("ul",[a("li",[s._v("Client：客户端，比如：APP客户端、web客户端（浏览器端）")]),s._v(" "),a("li",[s._v("Resource Owner：资源所有者，用户本人")]),s._v(" "),a("li",[s._v("Authorization Server：授权服务器，即提供第三方登录服务的服务器，如Github")]),s._v(" "),a("li",[s._v("Resource Server：拥有资源信息的服务器，通常和授权服务器属于同一应用")])]),s._v(" "),a("h2",{attrs:{id:"客户端的授权模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#客户端的授权模式"}},[s._v("#")]),s._v(" 客户端的授权模式")]),s._v(" "),a("p",[s._v("客户端必须得到用户的授权（authorization grant），才能获得令牌（access token）。OAuth 2.0定义了四种授权方式。")]),s._v(" "),a("ul",[a("li",[s._v("授权码模式（authorization code）")]),s._v(" "),a("li",[s._v("简化模式（implicit）")]),s._v(" "),a("li",[s._v("密码模式（resource owner password credentials）")]),s._v(" "),a("li",[s._v("客户端模式（client credentials）")])]),s._v(" "),a("h3",{attrs:{id:"授权码模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#授权码模式"}},[s._v("#")]),s._v(" 授权码模式")]),s._v(" "),a("p",[s._v('授权码模式（authorization code）是功能最完整、流程最严密的授权模式。它的特点就是通过客户端的后台服务器，与"服务提供商"的认证服务器进行互动。')]),s._v(" "),a("p",[a("img",{attrs:{src:"https://www.ruanyifeng.com/blogimg/asset/2014/bg2014051204.png",alt:"授权码模式"}})]),s._v(" "),a("p",[s._v("它的步骤如下：")]),s._v(" "),a("blockquote",[a("p",[s._v("（A）用户访问客户端，后者将前者导向认证服务器。")]),s._v(" "),a("p",[s._v("（B）用户选择是否给予客户端授权。")]),s._v(" "),a("p",[s._v('（C）假设用户给予授权，认证服务器将用户导向客户端事先指定的"重定向URI"（redirection URI），同时附上一个授权码。')]),s._v(" "),a("p",[s._v('（D）客户端收到授权码，附上早先的"重定向URI"，向认证服务器申请令牌。这一步是在客户端的后台的服务器上完成的，对用户不可见。')]),s._v(" "),a("p",[s._v("（E）认证服务器核对了授权码和重定向URI，确认无误后，向客户端发送访问令牌（access token）和更新令牌（refresh token）。")])]),s._v(" "),a("p",[s._v("下面是上面这些步骤所需要的参数。")]),s._v(" "),a("p",[s._v("A步骤中，客户端申请认证的URI，包含以下参数：")]),s._v(" "),a("ul",[a("li",[s._v('response_type：表示授权类型，必选项，此处的值固定为"code"')]),s._v(" "),a("li",[s._v("client_id：表示客户端的ID，必选项")]),s._v(" "),a("li",[s._v("redirect_uri：表示重定向URI，可选项")]),s._v(" "),a("li",[s._v("scope：表示申请的权限范围，可选项")]),s._v(" "),a("li",[s._v("state：表示客户端的当前状态，可以指定任意值，认证服务器会原封不动地返回这个值。")])]),s._v(" "),a("p",[s._v("下面是一个例子。")]),s._v(" "),a("blockquote",[a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[s._v("GET /authorize?response_type=code&client_id=s6BhdRkqt3&state=xyz\n     &redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb HTTP/1.1\n"),a("span",{pre:!0,attrs:{class:"token header"}},[a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token header-value"}},[s._v("server.example.com")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])]),s._v(" "),a("p",[s._v("C步骤中，服务器回应客户端的URI，包含以下参数：")]),s._v(" "),a("ul",[a("li",[s._v("code：表示授权码，必选项。该码的有效期应该很短，通常设为10分钟，客户端只能使用该码一次，否则会被授权服务器拒绝。该码与客户端ID和重定向URI，是一一对应关系。")]),s._v(" "),a("li",[s._v("state：如果客户端的请求中包含这个参数，认证服务器的回应也必须一模一样包含这个参数。")])]),s._v(" "),a("p",[s._v("下面是一个例子。")]),s._v(" "),a("blockquote",[a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[a("span",{pre:!0,attrs:{class:"token response-status"}},[a("span",{pre:!0,attrs:{class:"token http-version property"}},[s._v("HTTP/1.1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token status-code number"}},[s._v("302")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token reason-phrase string"}},[s._v("Found")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token header"}},[a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Location")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token header-value"}},[s._v("https://client.example.com/cb?code=SplxlOBeZQQYbYS6WxSbIA\n       &state=xyz")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])]),s._v(" "),a("p",[s._v("D步骤中，客户端向认证服务器申请令牌的HTTP请求，包含以下参数：")]),s._v(" "),a("ul",[a("li",[s._v('grant_type：表示使用的授权模式，必选项，此处的值固定为"authorization_code"。')]),s._v(" "),a("li",[s._v("code：表示上一步获得的授权码，必选项。")]),s._v(" "),a("li",[s._v("redirect_uri：表示重定向URI，必选项，且必须与A步骤中的该参数值保持一致。")]),s._v(" "),a("li",[s._v("client_id：表示客户端ID，必选项。")])]),s._v(" "),a("p",[s._v("下面是一个例子。")]),s._v(" "),a("blockquote",[a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[a("span",{pre:!0,attrs:{class:"token request-line"}},[a("span",{pre:!0,attrs:{class:"token method property"}},[s._v("POST")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token request-target url"}},[s._v("/token")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token http-version property"}},[s._v("HTTP/1.1")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token header"}},[a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token header-value"}},[s._v("server.example.com")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token header"}},[a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Authorization")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token header-value"}},[s._v("Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token header"}},[a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Content-Type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token header-value"}},[s._v("application/x-www-form-urlencoded")])]),s._v("\n\ngrant_type=authorization_code&code=SplxlOBeZQQYbYS6WxSbIA\n&redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])])]),s._v(" "),a("p",[s._v("E步骤中，认证服务器发送的HTTP回复，包含以下参数：")]),s._v(" "),a("ul",[a("li",[s._v("access_token：表示访问令牌，必选项。")]),s._v(" "),a("li",[s._v("token_type：表示令牌类型，该值大小写不敏感，必选项，可以是bearer类型或mac类型。")]),s._v(" "),a("li",[s._v("expires_in：表示过期时间，单位为秒。如果省略该参数，必须其他方式设置过期时间。")]),s._v(" "),a("li",[s._v("refresh_token：表示更新令牌，用来获取下一次的访问令牌，可选项。")]),s._v(" "),a("li",[s._v("scope：表示权限范围，如果与客户端申请的范围一致，此项可省略。")])]),s._v(" "),a("p",[s._v("下面是一个例子。")]),s._v(" "),a("blockquote",[a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[s._v('  HTTP/1.1 200 OK\n  Content-Type: application/json;charset=UTF-8\n  Cache-Control: no-store\n  Pragma: no-cache\n\n  {\n    "access_token":"2YotnFZFEjr1zCsicMWpAA",\n    "token_type":"example",\n    "expires_in":3600,\n    "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",\n    "example_parameter":"example_value"\n  }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])])]),s._v(" "),a("p",[s._v("从上面代码可以看到，相关参数使用JSON格式发送（Content-Type: application/json）。此外，HTTP头信息中明确指定不得缓存。")]),s._v(" "),a("h3",{attrs:{id:"简化模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简化模式"}},[s._v("#")]),s._v(" 简化模式")]),s._v(" "),a("p",[s._v('简化模式（implicit grant type）不通过第三方应用程序的服务器，直接在浏览器中向认证服务器申请令牌，跳过了"授权码"这个步骤，因此得名。所有步骤在浏览器中完成，令牌对访问者是可见的，且客户端不需要认证。')]),s._v(" "),a("p",[a("img",{attrs:{src:"https://www.ruanyifeng.com/blogimg/asset/2014/bg2014051205.png",alt:"简化模式"}})]),s._v(" "),a("p",[s._v("它的步骤如下：")]),s._v(" "),a("blockquote",[a("p",[s._v("（A）客户端将用户导向认证服务器。")]),s._v(" "),a("p",[s._v("（B）用户决定是否给于客户端授权。")]),s._v(" "),a("p",[s._v('（C）假设用户给予授权，认证服务器将用户导向客户端指定的"重定向URI"，并在URI的Hash部分包含了访问令牌。')]),s._v(" "),a("p",[s._v("（D）浏览器向资源服务器发出请求，其中不包括上一步收到的Hash值。")]),s._v(" "),a("p",[s._v("（E）资源服务器返回一个网页，其中包含的代码可以获取Hash值中的令牌。")]),s._v(" "),a("p",[s._v("（F）浏览器执行上一步获得的脚本，提取出令牌。")]),s._v(" "),a("p",[s._v("（G）浏览器将令牌发给客户端。")])]),s._v(" "),a("p",[s._v("下面是上面这些步骤所需要的参数。")]),s._v(" "),a("p",[s._v("A步骤中，客户端发出的HTTP请求，包含以下参数：")]),s._v(" "),a("ul",[a("li",[s._v('response_type：表示授权类型，此处的值固定为"token"，必选项。')]),s._v(" "),a("li",[s._v("client_id：表示客户端的ID，必选项。")]),s._v(" "),a("li",[s._v("redirect_uri：表示重定向的URI，可选项。")]),s._v(" "),a("li",[s._v("scope：表示权限范围，可选项。")]),s._v(" "),a("li",[s._v("state：表示客户端的当前状态，可以指定任意值，认证服务器会原封不动地返回这个值。")])]),s._v(" "),a("p",[s._v("下面是一个例子。")]),s._v(" "),a("blockquote",[a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[s._v(" GET /authorize?response_type=token&client_id=s6BhdRkqt3&state=xyz\n     &redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb HTTP/1.1\n Host: server.example.com\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])]),s._v(" "),a("p",[s._v("C步骤中，认证服务器回应客户端的URI，包含以下参数：")]),s._v(" "),a("ul",[a("li",[s._v("access_token：表示访问令牌，必选项。")]),s._v(" "),a("li",[s._v("token_type：表示令牌类型，该值大小写不敏感，必选项。")]),s._v(" "),a("li",[s._v("expires_in：表示过期时间，单位为秒。如果省略该参数，必须其他方式设置过期时间。")]),s._v(" "),a("li",[s._v("scope：表示权限范围，如果与客户端申请的范围一致，此项可省略。")]),s._v(" "),a("li",[s._v("state：如果客户端的请求中包含这个参数，认证服务器的回应也必须一模一样包含这个参数。")])]),s._v(" "),a("p",[s._v("下面是一个例子。")]),s._v(" "),a("blockquote",[a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[s._v("  HTTP/1.1 302 Found\n  Location: http://example.com/cb#access_token=2YotnFZFEjr1zCsicMWpAA\n            &state=xyz&token_type=example&expires_in=3600\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])]),s._v(" "),a("p",[s._v("在上面的例子中，认证服务器用HTTP头信息的Location栏，指定浏览器重定向的网址。注意，在这个网址的Hash部分包含了令牌。")]),s._v(" "),a("p",[s._v("根据上面的D步骤，下一步浏览器会访问Location指定的网址，但是Hash部分不会发送。接下来的E步骤，服务提供商的资源服务器发送过来的代码，会提取出Hash中的令牌。")]),s._v(" "),a("h3",{attrs:{id:"密码模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#密码模式"}},[s._v("#")]),s._v(" 密码模式")]),s._v(" "),a("p",[s._v('密码模式（Resource Owner Password Credentials Grant）中，用户向客户端提供自己的用户名和密码。客户端使用这些信息，向"服务商提供商"索要授权。')]),s._v(" "),a("p",[s._v("在这种模式中，用户必须把自己的密码给客户端，但是客户端不得储存密码。这通常用在用户对客户端高度信任的情况下，比如客户端是操作系统的一部分，或者由一个著名公司出品。而认证服务器只有在其他授权模式无法执行的情况下，才能考虑使用这种模式。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://www.ruanyifeng.com/blogimg/asset/2014/bg2014051206.png",alt:"密码模式"}})]),s._v(" "),a("p",[s._v("它的步骤如下：")]),s._v(" "),a("blockquote",[a("p",[s._v("（A）用户向客户端提供用户名和密码。")]),s._v(" "),a("p",[s._v("（B）客户端将用户名和密码发给认证服务器，向后者请求令牌。")]),s._v(" "),a("p",[s._v("（C）认证服务器确认无误后，向客户端提供访问令牌。")])]),s._v(" "),a("p",[s._v("B步骤中，客户端发出的HTTP请求，包含以下参数：")]),s._v(" "),a("ul",[a("li",[s._v('grant_type：表示授权类型，此处的值固定为"password"，必选项。')]),s._v(" "),a("li",[s._v("username：表示用户名，必选项。")]),s._v(" "),a("li",[s._v("password：表示用户的密码，必选项。")]),s._v(" "),a("li",[s._v("scope：表示权限范围，可选项。")])]),s._v(" "),a("p",[s._v("下面是一个例子。")]),s._v(" "),a("blockquote",[a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[s._v("  POST /token HTTP/1.1\n  Host: server.example.com\n  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW\n  Content-Type: application/x-www-form-urlencoded\n\n  grant_type=password&username=johndoe&password=A3ddj3w\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])]),s._v(" "),a("p",[s._v("C步骤中，认证服务器向客户端发送访问令牌，下面是一个例子。")]),s._v(" "),a("blockquote",[a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[s._v('  HTTP/1.1 200 OK\n  Content-Type: application/json;charset=UTF-8\n  Cache-Control: no-store\n  Pragma: no-cache\n\n  {\n    "access_token":"2YotnFZFEjr1zCsicMWpAA",\n    "token_type":"example",\n    "expires_in":3600,\n    "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",\n    "example_parameter":"example_value"\n  }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])])]),s._v(" "),a("p",[s._v("上面代码中，各个参数的含义参见《授权码模式》一节。")]),s._v(" "),a("p",[s._v("整个过程中，客户端不得保存用户的密码。")]),s._v(" "),a("h3",{attrs:{id:"客户端模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#客户端模式"}},[s._v("#")]),s._v(" 客户端模式")]),s._v(" "),a("p",[s._v('客户端模式（Client Credentials Grant）指客户端以自己的名义，而不是以用户的名义，向"服务提供商"进行认证。严格地说，客户端模式并不属于OAuth框架所要解决的问题。在这种模式中，用户直接向客户端注册，客户端以自己的名义要求"服务提供商"提供服务，其实不存在授权问题。')]),s._v(" "),a("p",[a("img",{attrs:{src:"https://www.ruanyifeng.com/blogimg/asset/2014/bg2014051207.png",alt:"客户端模式"}})]),s._v(" "),a("p",[s._v("它的步骤如下：")]),s._v(" "),a("blockquote",[a("p",[s._v("（A）客户端向认证服务器进行身份认证，并要求一个访问令牌。")]),s._v(" "),a("p",[s._v("（B）认证服务器确认无误后，向客户端提供访问令牌。")])]),s._v(" "),a("p",[s._v("A步骤中，客户端发出的HTTP请求，包含以下参数：")]),s._v(" "),a("ul",[a("li",[s._v("grant"),a("em",[s._v('type：表示授权类型，此处的值固定为"client')]),s._v('credentials"，必选项。')]),s._v(" "),a("li",[s._v("scope：表示权限范围，可选项。")])]),s._v(" "),a("blockquote",[a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[s._v("  POST /token HTTP/1.1\n  Host: server.example.com\n  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW\n  Content-Type: application/x-www-form-urlencoded\n\n  grant_type=client_credentials\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])]),s._v(" "),a("p",[s._v("认证服务器必须以某种方式，验证客户端身份。")]),s._v(" "),a("p",[s._v("B步骤中，认证服务器向客户端发送访问令牌，下面是一个例子。")]),s._v(" "),a("blockquote",[a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[s._v('  HTTP/1.1 200 OK\n  Content-Type: application/json;charset=UTF-8\n  Cache-Control: no-store\n  Pragma: no-cache\n\n  {\n    "access_token":"2YotnFZFEjr1zCsicMWpAA",\n    "token_type":"example",\n    "expires_in":3600,\n    "example_parameter":"example_value"\n  }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])])]),s._v(" "),a("p",[s._v("上面代码中，各个参数的含义参见《授权码模式》一节。")]),s._v(" "),a("h3",{attrs:{id:"刷新令牌"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#刷新令牌"}},[s._v("#")]),s._v(" 刷新令牌")]),s._v(" "),a("p",[s._v('如果用户访问的时候，客户端的"访问令牌"已经过期，则需要使用"刷新令牌"申请一个新的访问令牌。')]),s._v(" "),a("p",[s._v("客户端发出更新令牌的HTTP请求，包含以下参数：")]),s._v(" "),a("ul",[a("li",[s._v("grant"),a("em",[s._v('type：表示使用的授权模式，此处的值固定为"refresh')]),s._v('token"，必选项。')]),s._v(" "),a("li",[s._v("refresh_token：表示早前收到的更新令牌，必选项。")]),s._v(" "),a("li",[s._v("scope：表示申请的授权范围，不可以超出上一次申请的范围，如果省略该参数，则表示与上一次一致。")])]),s._v(" "),a("p",[s._v("下面是一个例子。")]),s._v(" "),a("blockquote",[a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[s._v("  POST /token HTTP/1.1\n  Host: server.example.com\n  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW\n  Content-Type: application/x-www-form-urlencoded\n\n  grant_type=refresh_token&refresh_token=tGzv3JOkF0XG5Qx2TlKWIA\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])]),s._v(" "),a("p",[s._v("（完）")]),s._v(" "),a("h2",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[s._v("#")]),s._v(" 参考资料")]),s._v(" "),a("p",[s._v("理解OAuth 2.0 - 阮一峰的网络日志\nhttps://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html")])])}),[],!1,null,null,null);e.default=n.exports}}]);