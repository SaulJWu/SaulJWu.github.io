(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{554:function(s,a,t){"use strict";t.r(a);var n=t(15),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("断言（Assertion）是一种调试程序的方式。在Java中，使用"),t("code",[s._v("assert")]),s._v("关键字来实现断言。")]),s._v(" "),t("p",[s._v("我们先看一个例子：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("public static void main(String[] args) {\n    double x = Math.abs(-123.45);\n    assert x >= 0;\n    System.out.println(x);\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("语句"),t("code",[s._v("assert x >= 0;")]),s._v("即为断言，断言条件"),t("code",[s._v("x >= 0")]),s._v("预期为"),t("code",[s._v("true")]),s._v("。如果计算结果为"),t("code",[s._v("false")]),s._v("，则断言失败，抛出"),t("code",[s._v("AssertionError")]),s._v("。")]),s._v(" "),t("p",[s._v("使用"),t("code",[s._v("assert")]),s._v("语句时，还可以添加一个可选的断言消息：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('assert x >= 0 : "x must >= 0";\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("这样，断言失败的时候，"),t("code",[s._v("AssertionError")]),s._v("会带上消息"),t("code",[s._v("x must >= 0")]),s._v("，更加便于调试。")]),s._v(" "),t("p",[s._v("Java断言的特点是：断言失败时会抛出"),t("code",[s._v("AssertionError")]),s._v("，导致程序结束退出。因此，断言不能用于可恢复的程序错误，只应该用于开发和测试阶段。")]),s._v(" "),t("p",[s._v("对于可恢复的程序错误，不应该使用断言。例如：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("void sort(int[] arr) {\n    assert arr != null;\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("应该抛出异常并在上层捕获：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('void sort(int[] arr) {\n    if (x == null) {\n        throw new IllegalArgumentException("array cannot be null");\n    }\n}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("当我们在程序中使用"),t("code",[s._v("assert")]),s._v("时，例如，一个简单的断言：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Main")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" x "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("assert")]),s._v(" x "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("运行结果：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("-1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("断言"),t("code",[s._v("x")]),s._v("必须大于"),t("code",[s._v("0")]),s._v("，实际上"),t("code",[s._v("x")]),s._v("为"),t("code",[s._v("-1")]),s._v("，断言肯定失败。执行上述代码，发现程序并未抛出"),t("code",[s._v("AssertionError")]),s._v("，而是正常打印了"),t("code",[s._v("x")]),s._v("的值。")]),s._v(" "),t("p",[s._v("这是怎么肥四？为什么"),t("code",[s._v("assert")]),s._v("语句不起作用？")]),s._v(" "),t("p",[s._v("这是因为JVM默认关闭断言指令，即遇到"),t("code",[s._v("assert")]),s._v("语句就自动忽略了，不执行。")]),s._v(" "),t("p",[s._v("要执行"),t("code",[s._v("assert")]),s._v("语句，必须给Java虚拟机传递"),t("code",[s._v("-enableassertions")]),s._v("（可简写为"),t("code",[s._v("-ea")]),s._v("）参数启用断言。所以，上述程序必须在命令行下运行才有效果：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('$ java -ea Main.java\nException in thread "main" java.lang.AssertionError\n\tat Main.main(Main.java:5)\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("还可以有选择地对特定地类启用断言，命令行参数是："),t("code",[s._v("-ea:com.itranswarp.sample.Main")]),s._v("，表示只对"),t("code",[s._v("com.itranswarp.sample.Main")]),s._v("这个类启用断言。")]),s._v(" "),t("p",[s._v("或者对特定地包启用断言，命令行参数是："),t("code",[s._v("-ea:com.itranswarp.sample...")]),s._v("（注意结尾有3个"),t("code",[s._v(".")]),s._v("），表示对"),t("code",[s._v("com.itranswarp.sample")]),s._v("这个包启动断言。")]),s._v(" "),t("p",[s._v("实际开发中，很少使用断言。更好的方法是编写单元测试，后续我们会讲解"),t("code",[s._v("JUnit")]),s._v("的使用。")]),s._v(" "),t("h3",{attrs:{id:"小结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("断言是一种调试方式，断言失败会抛出"),t("code",[s._v("AssertionError")]),s._v("，只能在开发和测试阶段启用断言；")])]),s._v(" "),t("li",[t("p",[s._v("对可恢复的错误不能使用断言，而应该抛出异常；")])]),s._v(" "),t("li",[t("p",[s._v("断言很少被使用，更好的方法是编写单元测试。")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);