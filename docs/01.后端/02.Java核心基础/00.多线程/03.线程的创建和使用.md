---
title: 线程的创建和使用
date: 2020-12-17 12:47:40
permalink: /pages/81ea6e/
categories:
  - 后端
  - Java核心基础
  - 多线程
tags:
  - Thread类
---
> 这是多线程吗？

~~~java
public class Sample{
    public void method1(String str){
        System.out.println(str);
    }
    
    public void method2(String str){
        method1(str);
    }
    
    public static void main(String[] args){
        Sample s = new Sample();
        s.method2("hello!");
    }
}
~~~

不是多线程，这个案例一条线程就可以完成了。



## Thread类

- `Java`语言的`JVM`允许程序运行多个线程，它通过`java.lang.Thread`类来体现。
- `Thread`类的特性
  - 每个线程都是通过某个特定`Thread`对象的`run()`方法来完成操作的，经常**把`run()`方法的主体称为线程体**。
  - 通过该`Thread`对象的`start()`方法来启动这个线程，而非直接调用`run()`。



> 构造器

- `Thread()`：创建新的Thread对象。
- `Thread(String threadname)`：创建线程并指定线程实例名。
- `Thread(Runnabletarget)`：指定创建线程的目标对象，它实现了`Runnable`接口中的`run()`方法。
- `Thread(Runnable target, String name)`：创建新的`Thread`对象。



## 实现方式

> API中创建线程的两种方式

**JDK1.5之前创建新执行线程有两种方法：**

- 1、继承`Thread`类的方式
- 2、实现`Runnable`接口的方式





### 方式一：继承`Thread`类

1. 定义子类继承`Thread`类。
2. 子类中重写`Thread`类中的`run()`方法.
3. 创建`Thread`子类对象，即创建了线程对象。
4. 调用线程对象`start`方法：启动线程，调用`run`方法。



**Java Platform SE 8**：

> There are two ways to create a new thread of execution. One is to declare a  class to be a subclass of `Thread`. This subclass should override the  `run` method of class `Thread`. An instance of the  subclass can then be allocated and started. For example, a thread that computes  primes larger than a stated value could be written as follows: 

~~~java
class PrimeThread extends Thread {
         long minPrime;
         PrimeThread(long minPrime) {
             this.minPrime = minPrime;
         }

         public void run() {
             // compute primes larger than minPrime
              . . .
         }
     }

~~~



比如：遍历100以内的奇数和偶数，分开线程实现：

~~~java
public class MyThread extends Thread {

    @Override
    public void run() {
        for (int i = 0; i < 100; i++) {
            if (i % 2 == 0) {
                System.out.println("---子线程--- i = " + i);
            }
        }
    }
}
~~~

~~~java
class MyThreadTest {

    @Test
    void run() {
        MyThread t1 = new MyThread();
        t1.start();
        for (int i = 0; i < 100; i++) {
            if (i % 2 != 0) {
                System.out.println("***主线程*** i = " + i);
            }
        }
    }
}
~~~

输出结果：

![image-20201217142453580](https://raw.githubusercontent.com/SaulJWu/images/main/20201217142453.png)

可以看到2个线程都是独立运行的。



> 注意点：

- 如果自己手动调用`run()`方法，那么就只是普通方法，没有启动多线程模式。
- **`run()`方法由`JVM`调用，什么时候调用，执行的过程控制都有操作系统的`CPU`调度决定。**
- **想要启动多线程，必须调用`start`方法。**
- 一个线程对象只能调用一次`start()`方法启动，如果重复调用了，则将抛出以上的异常“`IllegalThreadStateException`”。



### 方式二：实现`Runnable`接口

1. 定义子类，实现`Runnable`接口。
2. 子类中重写`Runnable`接口中的`run`方法。
3. 通过`Thread`类含参构造器创建线程对象。
4. 将`Runnable`接口的子类对象作为实际参数传递给`Thread`类的构造器中。
5. 调用`Thread`类的`start`方法：开启线程，调用`Runnable`子类接口的`run`方法。