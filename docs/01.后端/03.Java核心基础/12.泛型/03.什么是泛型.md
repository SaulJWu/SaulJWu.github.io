---
title: ä»€ä¹ˆæ˜¯æ³›å‹
date: 2021-01-07 12:26:29
permalink: /pages/c6fc57/
categories:
  - åç«¯
  - Javaæ ¸å¿ƒåŸºç¡€
  - æ³›å‹
tags:
  - æ³›å‹
  - T
---
æ³›å‹æ˜¯ä¸€ç§â€œä»£ç æ¨¡æ¿â€ï¼Œå¯ä»¥ç”¨ä¸€å¥—ä»£ç å¥—ç”¨å„ç§ç±»å‹ã€‚

![java-generics](https://raw.githubusercontent.com/SaulJWu/images/main/20210107123012.png)

æœ¬èŠ‚æˆ‘ä»¬è¯¦ç»†è®¨è®ºJavaçš„æ³›å‹ç¼–ç¨‹ã€‚



åœ¨è®²è§£ä»€ä¹ˆæ˜¯æ³›å‹ï¼ˆGenericï¼‰ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè§‚å¯ŸJavaæ ‡å‡†åº“æä¾›çš„`ArrayList`ï¼Œå®ƒå¯ä»¥çœ‹ä½œâ€œå¯å˜é•¿åº¦â€çš„æ•°ç»„ï¼Œå› ä¸ºç”¨èµ·æ¥æ¯”æ•°ç»„æ›´æ–¹ä¾¿ã€‚ğŸ¤



å®é™…ä¸Š`ArrayList`å†…éƒ¨å°±æ˜¯ä¸€ä¸ª`Object[]`æ•°ç»„ï¼Œé…åˆå­˜å‚¨ä¸€ä¸ªå½“å‰åˆ†é…çš„é•¿åº¦ï¼Œå°±å¯ä»¥å……å½“â€œå¯å˜æ•°ç»„â€ï¼š

```java
public class ArrayList {
    private Object[] array;
    private int size;
    public void add(Object e) {...}
    public void remove(int index) {...}
    public Object get(int index) {...}
}
```

å¦‚æœç”¨ä¸Šè¿°`ArrayList`å­˜å‚¨`String`ç±»å‹ï¼Œä¼šæœ‰è¿™ä¹ˆå‡ ä¸ªç¼ºç‚¹ï¼š

- éœ€è¦å¼ºåˆ¶è½¬å‹ï¼›
- ä¸æ–¹ä¾¿ï¼Œæ˜“å‡ºé”™ã€‚

ä¾‹å¦‚ï¼Œä»£ç å¿…é¡»è¿™ä¹ˆå†™ï¼š

```java
ArrayList list = new ArrayList();
list.add("Hello");
// è·å–åˆ°Objectï¼Œå¿…é¡»å¼ºåˆ¶è½¬å‹ä¸ºString:
String first = (String) list.get(0);
```

å¾ˆå®¹æ˜“å‡ºç°ClassCastExceptionï¼Œå› ä¸ºå®¹æ˜“â€œè¯¯è½¬å‹â€ï¼š

```java
list.add(new Integer(123));
// ERROR: ClassCastException:
String second = (String) list.get(1);
```

è¦è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä¸º`String`å•ç‹¬ç¼–å†™ä¸€ç§`ArrayList`ï¼š

```java
public class StringArrayList {
    private String[] array;
    private int size;
    public void add(String e) {...}
    public void remove(int index) {...}
    public String get(int index) {...}
}
```

è¿™æ ·ä¸€æ¥ï¼Œå­˜å…¥çš„å¿…é¡»æ˜¯`String`ï¼Œå–å‡ºçš„ä¹Ÿä¸€å®šæ˜¯`String`ï¼Œä¸éœ€è¦å¼ºåˆ¶è½¬å‹ï¼Œå› ä¸ºç¼–è¯‘å™¨ä¼šå¼ºåˆ¶æ£€æŸ¥æ”¾å…¥çš„ç±»å‹ï¼š

```java
StringArrayList list = new StringArrayList();
list.add("Hello");
String first = list.get(0);
// ç¼–è¯‘é”™è¯¯: ä¸å…è®¸æ”¾å…¥éStringç±»å‹:
list.add(new Integer(123));
```

é—®é¢˜æš‚æ—¶è§£å†³ã€‚

ç„¶è€Œï¼Œæ–°çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœè¦å­˜å‚¨`Integer`ï¼Œè¿˜éœ€è¦ä¸º`Integer`å•ç‹¬ç¼–å†™ä¸€ç§`ArrayList`ï¼š

```java
public class IntegerArrayList {
    private Integer[] array;
    private int size;
    public void add(Integer e) {...}
    public void remove(int index) {...}
    public Integer get(int index) {...}
}
```

å®é™…ä¸Šï¼Œè¿˜éœ€è¦ä¸ºå…¶ä»–æ‰€æœ‰classå•ç‹¬ç¼–å†™ä¸€ç§`ArrayList`ï¼š

- LongArrayList
- DoubleArrayList
- PersonArrayList
- ...

è¿™æ˜¯ä¸å¯èƒ½çš„ï¼ŒJDKçš„classå°±æœ‰ä¸Šåƒä¸ªï¼Œè€Œä¸”å®ƒè¿˜ä¸çŸ¥é“å…¶ä»–äººç¼–å†™çš„classã€‚

ä¸ºäº†è§£å†³æ–°çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¿…é¡»æŠŠ`ArrayList`å˜æˆä¸€ç§æ¨¡æ¿ï¼š`ArrayList<T>`ï¼Œä»£ç å¦‚ä¸‹ï¼š

```java
public class ArrayList<T> {
    private T[] array;
    private int size;
    public void add(T e) {...}
    public void remove(int index) {...}
    public T get(int index) {...}
}
```

`T`å¯ä»¥æ˜¯ä»»ä½•classã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å®ç°äº†ï¼šç¼–å†™ä¸€æ¬¡æ¨¡ç‰ˆï¼Œå¯ä»¥åˆ›å»ºä»»æ„ç±»å‹çš„`ArrayList`ï¼š

```java
// åˆ›å»ºå¯ä»¥å­˜å‚¨Stringçš„ArrayList:
ArrayList<String> strList = new ArrayList<String>();
// åˆ›å»ºå¯ä»¥å­˜å‚¨Floatçš„ArrayList:
ArrayList<Float> floatList = new ArrayList<Float>();
// åˆ›å»ºå¯ä»¥å­˜å‚¨Personçš„ArrayList:
ArrayList<Person> personList = new ArrayList<Person>();
```

å› æ­¤ï¼Œæ³›å‹å°±æ˜¯å®šä¹‰ä¸€ç§æ¨¡æ¿ï¼Œä¾‹å¦‚`ArrayList<T>`ï¼Œç„¶ååœ¨ä»£ç ä¸­ä¸ºç”¨åˆ°çš„ç±»åˆ›å»ºå¯¹åº”çš„`ArrayList<ç±»å‹>`ï¼š

```java
ArrayList<String> strList = new ArrayList<String>();
```

ç”±ç¼–è¯‘å™¨é’ˆå¯¹ç±»å‹ä½œæ£€æŸ¥ï¼š

```java
strList.add("hello"); // OK
String s = strList.get(0); // OK
strList.add(new Integer(123)); // compile error!
Integer n = strList.get(0); // compile error!
```

è¿™æ ·ä¸€æ¥ï¼Œæ—¢å®ç°äº†ç¼–å†™ä¸€æ¬¡ï¼Œä¸‡èƒ½åŒ¹é…ï¼Œåˆé€šè¿‡ç¼–è¯‘å™¨ä¿è¯äº†ç±»å‹å®‰å…¨ï¼šè¿™å°±æ˜¯æ³›å‹ã€‚

## å‘ä¸Šè½¬å‹

åœ¨Javaæ ‡å‡†åº“ä¸­çš„`ArrayList<T>`å®ç°äº†`List<T>`æ¥å£ï¼Œå®ƒå¯ä»¥å‘ä¸Šè½¬å‹ä¸º`List<T>`ï¼š

```java
public class ArrayList<T> implements List<T> {
    ...
}

List<String> list = new ArrayList<String>();
```

å³ç±»å‹`ArrayList<T>`å¯ä»¥å‘ä¸Šè½¬å‹ä¸º`List<T>`ã€‚

è¦*ç‰¹åˆ«æ³¨æ„*ï¼šä¸èƒ½æŠŠ`ArrayList<Integer>`å‘ä¸Šè½¬å‹ä¸º`ArrayList<Number>`æˆ–`List<Number>`ã€‚

è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå‡è®¾`ArrayList<Integer>`å¯ä»¥å‘ä¸Šè½¬å‹ä¸º`ArrayList<Number>`ï¼Œè§‚å¯Ÿä¸€ä¸‹ä»£ç ï¼š

```java
// åˆ›å»ºArrayList<Integer>ç±»å‹ï¼š
ArrayList<Integer> integerList = new ArrayList<Integer>();
// æ·»åŠ ä¸€ä¸ªIntegerï¼š
integerList.add(new Integer(123));
// â€œå‘ä¸Šè½¬å‹â€ä¸ºArrayList<Number>ï¼š
ArrayList<Number> numberList = integerList;
// æ·»åŠ ä¸€ä¸ªFloatï¼Œå› ä¸ºFloatä¹Ÿæ˜¯Numberï¼š
numberList.add(new Float(12.34));
// ä»ArrayList<Integer>è·å–ç´¢å¼•ä¸º1çš„å…ƒç´ ï¼ˆå³æ·»åŠ çš„Floatï¼‰ï¼š
Integer n = integerList.get(1); // ClassCastException!
```

æˆ‘ä»¬æŠŠä¸€ä¸ª`ArrayList<Integer>`è½¬å‹ä¸º`ArrayList<Number>`ç±»å‹åï¼Œè¿™ä¸ª`ArrayList<Number>`å°±å¯ä»¥æ¥å—`Float`ç±»å‹ï¼Œå› ä¸º`Float`æ˜¯`Number`çš„å­ç±»ã€‚ä½†æ˜¯ï¼Œ`ArrayList<Number>`å®é™…ä¸Šå’Œ`ArrayList<Integer>`æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯`ArrayList<Integer>`ç±»å‹ï¼Œå®ƒä¸å¯èƒ½æ¥å—`Float`ç±»å‹ï¼Œ æ‰€ä»¥åœ¨è·å–`Integer`çš„æ—¶å€™å°†äº§ç”Ÿ`ClassCastException`ã€‚

å®é™…ä¸Šï¼Œç¼–è¯‘å™¨ä¸ºäº†é¿å…è¿™ç§é”™è¯¯ï¼Œæ ¹æœ¬å°±ä¸å…è®¸æŠŠ`ArrayList<Integer>`è½¬å‹ä¸º`ArrayList<Number>`ã€‚

 `ArrayList<Integer>`å’Œ`ArrayList<Number>`ä¸¤è€…å®Œå…¨æ²¡æœ‰ç»§æ‰¿å…³ç³»ã€‚

## å°ç»“

æ³›å‹å°±æ˜¯ç¼–å†™æ¨¡æ¿ä»£ç æ¥é€‚åº”ä»»æ„ç±»å‹ï¼›

æ³›å‹çš„å¥½å¤„æ˜¯ä½¿ç”¨æ—¶ä¸å¿…å¯¹ç±»å‹è¿›è¡Œå¼ºåˆ¶è½¬æ¢ï¼Œå®ƒé€šè¿‡ç¼–è¯‘å™¨å¯¹ç±»å‹è¿›è¡Œæ£€æŸ¥ï¼›

æ³¨æ„æ³›å‹çš„ç»§æ‰¿å…³ç³»ï¼šå¯ä»¥æŠŠ`ArrayList<Integer>`å‘ä¸Šè½¬å‹ä¸º`List<Integer>`ï¼ˆ`T`ä¸èƒ½å˜ï¼ï¼‰ï¼Œä½†ä¸èƒ½æŠŠ`ArrayList<Integer>`å‘ä¸Šè½¬å‹ä¸º`ArrayList<Number>`ï¼ˆ`T`ä¸èƒ½å˜æˆçˆ¶ç±»ï¼‰ã€‚